---
title: Конфликты при слиянии веток
permalink: /files/razdel_6_konflikty_pri_slianii_vetok/
---


<h3 id="o_konfliktah">О конфликтах</h3>

Конфликты возникают при слиянии веток, где имеются конкурирующие фиксации в файлах. Git не понимает какие изменения следует включать в окончательное слияние, поэтому конфликты решаются вручную исполнителем задачи. До решения конфликта кнопка **Merge pull reguest** недоступна.

*Причины появления конфликтов*:

1. Исполнитель перешел в ветку, в которой были опубликованы новые изменения, не подтянул изменения командой `git pull` (см. подраздел [Правка инструкции по другому проекту в новой ветке](/primery/files/razdel_7_szenarii_raboty_s_git/)), внес изменения в файле и опубликовал.

2. Двое исполнителей, работая в одной или двух разных ветках, вносят разные изменения в одну строку одного файла.  

> Если исполнители будут работать в одной ветке, но в разных строках файлов, и подтягивать изменения друг друга командой `git pull` перед окончательной публикацией (см. подраздел [Правка инструкции с другим исполнителем в одной ветке](/primery/files/razdel_7_szenarii_raboty_s_git/)), то конфликтов не возникнет.
>

3. Один исполнитель редактирует файл, а другой — удаляет этот же файл. 

*Мониторинг конфликтов*

Отследить конфликт проще всего в VS Code с помощью вкладки *Source Control Graph*. Если на графе отображается более двух ответвлений от первой линии, то при слиянии возникнет конфликт.

 ![текст](images/konflict_na_grafe.png)

К примеру, на рис. выше отмечен момент создания конфликта (1), момент решения конфликта (2) и слияния с веткой *main* (3).

<h3 id="reshenie_konfliktov_sliania">Решение конфликтов слияния</h3>

**Первый способ**: если конфликт слияния вызван конкурирующими изменениями строк, например при внесении разных изменений в одну строку одного файла в разных ветках репозитория Git, то его _**решают на GitHub с помощью редактора конфликтов**_.

1. Перейдите в раздел **Pull requests** на GitHub (см. шаг 3 подраздела [Запрос на слияние веток (merge pull request)](/primery/files/razdel_5_rabota_s_udalenym_repozitoriem/)).

   Откроется страница с уведомлением о конфликте.

   ![текст](images/uvedomlenie_o_konflikte.png)

2. Нажмите кнопку **Resolve conflicts**.

   Откроется редактор конфликтов.

   ![текст](images/redaktor_konfliktov.png)

   Для данного файла в ветке *main* строке 6 было выполнено одно изменение, а в ветке *test_vetka2* строке 12 — другое. Поэтому срока 6 выделена жирным.

   Для решения конфликта достаточно выбрать между строкой 6 и 12, оставив нужную, а повторяющиеся предложения удалить.

3. Выделите ненужные строки и удалите их. Например, с 7-13.

   ![текст](images/reshenie_konflikta.png)

4. Нажмите кнопку **Mark as resolved**.
   
   Если конфликт устранен, то напротив файла отобразится зеленная галочка.

   ![текст](images/konflikt_reshen.png)

5. Нажмите кнопку **Commit merge**.

   Откроется cтраница слияния веток.

   ![текст](images/zapros_na_slianie_bez_konflikta.png)

6. Выполните шаги 3-4 подраздела [Запрос на слияние веток (merge pull request)](/primery/files/razdel_5_rabota_s_udalenym_repozitoriem/).

**Второй способ**: остальные типы конфликтов слияния _**решают в локальном репозитории с помощью IDE VS Code**_ и отправляют изменения в ветку на GitHub.

> Данный способ применим в компаниях, где над проектом работает много специалистов. 
>
   
1. Откройте проект в VS Code.

2. Откройте конфликтный файл. Помечается в проекте восклицательным знаком.

   ![текст](images/konflikt_fail.png)

   Конфликтная часть находится между скобочками <<<<<<< >>>>>>>. В зеленом блоке отображаются изменения из ветки *test_vetka2*, которая является текущей веткой (или HEAD) репозитория. В синем блоке отображаются изменения из ветки *main*, т.е. ветка в которую сливаются изменения из ветки *test_vetka2*.

   Конкурирующие изменения в строках подчеркнуты красным цветом в зеленом и синем блоке.

   ![текст](images/konflikt_bloki.png)

   Для решения конфликта достаточно выбрать изменения между зеленым и синим блоком, либо объединить их любым удобным способом, скобочки <<<<<<< >>>>>>> и значки ======= убрать.

   Если на данном шаге нужные изменения не будут выбраны, то при нажитии на кнопку **Resolve in Merge Editor** в редакторе слияния автоматически отобразятся изменения только из зеленого блока. 

3. Нажмите кнопку **Resolve in Merge Editor**.

   Откроется _Merging: file.md_ или редактор слияния. В блоке _Result_ отобразится предварительный просмотр решения конфликта.

   ![текст](images/konflikt_predfreshenie.png)

   Достаточно проверить блок _Result_, внести окончательные правки перед слиянием.

4. Нажмите кнопку **Complete Merge**.

   Откроется модальное окно подтверждения слияния.

5. Нажмите кнопку **Complete with Conflicts**.

   Закроется _Merging: file.md_, в файле _file. md_ отобразятся принятые изменения.

   ![текст](images/fail_bez_konflikta.png)

6. Перейдите в терминал Git Bash и выполните последовательно команды:

   6.1. `git add .`.
   
   6.2. `git commit -m "merge branch"`.

   6.3. `git push -u origin test_vetka2`.

7. Выполните заново все шаги подраздела [Запрос на принятие изменений (pull request)](/primery/files/razdel_5_rabota_s_udalenym_repozitoriem/) и [Запрос на слияние веток (merge pull request)](/primery/files/razdel_5_rabota_s_udalenym_repozitoriem/). 


**Третий способ**: универсальный алгоритм решения конфликтов.

1. Перейдите в ветку *main*.

2. Загрузите новые изменения с помощью команды `git pull`.

3. Вернитесь в свою ветку.

4. Выполните команду `git merge main` и разрешите конфликт локально (см. шаг 2 **второго способа** решения конфликтов). 
   
   Создастся локальный коммит слияния.

5. Выполните шаги 6-7 **второго способа** решения конфликтов.
